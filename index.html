<!DOCTYPE html>
<html lang="gu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>કારીગર મિત્ર PRO</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<!-- Alert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
:root{
--primary:#1e40af;
--bg:#f8fafc;
--dark:#0f172a;
--success:#16a34a;
}

body{
margin:0;
font-family:'Segoe UI','Noto Sans Gujarati',sans-serif;
background:var(--bg);
padding-bottom:80px;
}

/* HEADER */
.header{
background:linear-gradient(135deg,#1e40af,#1e3a8a);
color:white;
padding:18px;
text-align:center;
font-size:20px;
font-weight:bold;
position:sticky;
top:0;
z-index:100;
}

/* TABS */
.tab-nav{
display:flex;
background:white;
border-bottom:1px solid #ddd;
position:sticky;
top:64px;
z-index:99;
}
.tab-btn{
flex:1;
padding:12px;
border:none;
background:none;
font-weight:bold;
cursor:pointer;
}
.tab-btn.active{
color:var(--primary);
border-bottom:3px solid var(--primary);
}

/* SECTION */
.section{display:none;padding:15px;}
.section.active{display:block}

/* 3D CATEGORY CARD */
.grid{
display:grid;
grid-template-columns:repeat(2,1fr);
gap:15px;
}
.cat-card{
background:white;
border-radius:18px;
padding:25px 15px;
text-align:center;
box-shadow:0 15px 25px rgba(0,0,0,0.15);
transform-style:preserve-3d;
transition:0.4s;
cursor:pointer;
}
.cat-card:hover{
transform:rotateX(10deg) rotateY(-10deg) translateY(-8px);
box-shadow:0 25px 40px rgba(0,0,0,0.25);
}
.cat-card i{
font-size:36px;
color:var(--primary);
margin-bottom:10px;
}

/* INPUT */
input,select,textarea{
width:100%;
padding:12px;
margin:8px 0;
border-radius:10px;
border:1px solid #ccc;
}

/* BUTTON */
.btn{
padding:12px;
border:none;
border-radius:10px;
font-weight:bold;
cursor:pointer;
}
.btn-main{
background:linear-gradient(to right,#1e40af,#3b82f6);
color:white;
}

/* ORDER BOX */
.box{
background:white;
padding:15px;
border-radius:12px;
margin-bottom:12px;
box-shadow:0 6px 15px rgba(0,0,0,0.08);
}

/* RADIUS */
.radius-box{
background:#e0e7ff;
padding:12px;
border-radius:10px;
margin-bottom:15px;
text-align:center;
font-weight:bold;
}
</style>
</head>

<body>

<div class="header">કારીગર મિત્ર PRO</div>

<div class="tab-nav">
<button class="tab-btn active" onclick="showTab('user')">ગ્રાહક</button>
<button class="tab-btn" onclick="showTab('reg')">કારીગર જોડાવો</button>
<button class="tab-btn" onclick="showTab('admin')">ઓર્ડર</button>
<button class="tab-btn" onclick="adminLogin()">એડમિન</button>
</div>

<!-- USER -->
<div id="user" class="section active">

<div class="radius-box">
Radius:
<input type="range" min="1" max="20" value="5" id="radius"
oninput="document.getElementById('rVal').innerText=this.value">
<span id="rVal">5</span> km
</div>

<div class="grid" id="catGrid"></div>
<hr>
<div id="userOrders"></div>
</div>

<!-- REG -->
<div id="reg" class="section">
<input id="wName" placeholder="નામ">
<input id="wPhone" placeholder="મોબાઈલ">
<select id="wCat"></select>
<button class="btn btn-main" onclick="registerWorker()">Apply</button>
</div>

<!-- ADMIN ORDERS -->
<div id="admin" class="section">
<div id="allOrders"></div>
</div>

<!-- SUPER ADMIN -->
<div id="super" class="section">
<h3>Pending Workers</h3>
<div id="pending"></div>
<h3>Approved Workers</h3>
<div id="approved"></div>
</div>

<script>
/* ---------------- CONFIG ---------------- */
const firebaseConfig={
apiKey:"AIzaSyCTk0sFvZmY6olGOHwK59z-TYoSSj8_l0o",
authDomain:"karigar-mitra-9c6be.firebaseapp.com",
projectId:"karigar-mitra-9c6be"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

/* ---------------- DATA ---------------- */
const cats=[
{n:"ઇલેક્ટ્રીશિયન",i:"bolt"},
{n:"પ્લમ્બર",i:"faucet"},
{n:"AC રીપેરીંગ",i:"snowflake"},
{n:"પેઇન્ટર",i:"paint-brush"}
];

/* ---------------- INIT ---------------- */
cats.forEach(c=>{
catGrid.innerHTML+=`
<div class="cat-card" onclick="book('${c.n}')">
<i class="fas fa-${c.i}"></i><br><b>${c.n}</b>
</div>`;
wCat.innerHTML+=`<option>${c.n}</option>`;
});

/* ---------------- UI ---------------- */
function showTab(id){
document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
}

/* ---------------- BOOK ---------------- */
function book(cat){
Swal.fire({
title:cat,
input:'text',
inputPlaceholder:'મોબાઈલ નંબર',
confirmButtonText:'બુક કરો'
}).then(r=>{
if(r.isConfirmed){
db.collection("orders").add({
category:cat,
phone:r.value,
status:"New",
time:firebase.firestore.FieldValue.serverTimestamp()
});
Swal.fire("Success","Booking Done","success");
}
});
}

/* ---------------- REGISTER ---------------- */
function registerWorker(){
db.collection("workers").add({
name:wName.value,
phone:wPhone.value,
category:wCat.value,
status:"Pending"
});
Swal.fire("Done","Request Sent","success");
}

/* ---------------- ADMIN LOGIN ---------------- */
function adminLogin(){
Swal.fire({
title:"Admin Password",
input:"password"
}).then(r=>{
if(r.value==="1234"){showTab('super')}
});
}

/* ---------------- ADMIN ACTIONS ---------------- */
db.collection("workers").onSnapshot(snap=>{
pending.innerHTML="";
approved.innerHTML="";
snap.forEach(d=>{
let w=d.data();
let box=`<div class="box">
<b>${w.name}</b><br>${w.category}<br>${w.phone}<br>
${w.status==="Pending"
?`<button onclick="approve('${d.id}')">Approve</button>
<button onclick="del('${d.id}')">Delete</button>`
:`<button onclick="del('${d.id}')">Delete</button>`}
</div>`;
w.status==="Pending"?pending.innerHTML+=box:approved.innerHTML+=box;
});
});

function approve(id){
db.collection("workers").doc(id).update({status:"Approved"});
}
function del(id){
db.collection("workers").doc(id).delete();
}
</script>
</body>
</html>

